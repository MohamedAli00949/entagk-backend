"use strict";(self.webpackChunkpomodoro_=self.webpackChunkpomodoro_||[]).push([[804],{2804:function(o,e,n){n.r(e),n.d(e,{default:function(){return f}});var t=n(885),i=n(2791),l=n(9434),r=n(601),a=n(7710),c=n(771),u=n(6409),d=n(184),s=(0,i.lazy)((function(){return n.e(178).then(n.bind(n,2178))})),m=(0,i.lazy)((function(){return Promise.all([n.e(578),n.e(23)]).then(n.bind(n,9023))})),v=new window.Worker("worker.js"),f=function(){var o,e,n,f,p,g=(0,l.v9)((function(o){return o.timer})),y=g.active,h=g.activites,k=g.setting,w=g.started,T=g.periodNum,b=(0,l.v9)((function(o){return o.tasks})).activeId,I=(0,i.useState)(null===localStorage.getItem("restOfTime")?0:Number(localStorage.getItem("restOfTime"))),N=(0,t.Z)(I,2),S=N[0],P=N[1],j=null===k||void 0===k?void 0:k.time[y],V=(0,l.I0)(),x=(0,i.useRef)("none"!==(null===k||void 0===k||null===(o=k.tickingType)||void 0===o?void 0:o.name)?(0,c.Z)({src:null===k||void 0===k||null===(e=k.tickingType)||void 0===e?void 0:e.src,volume:null===k||void 0===k?void 0:k.tickingVolume,loop:!0}):null),B=(0,i.useRef)((0,c.Z)({src:null===k||void 0===k||null===(n=k.alarmType)||void 0===n?void 0:n.src,volume:null===k||void 0===k?void 0:k.alarmVolume,loop:null===k||void 0===k?void 0:k.alarmRepet})),F=(0,i.useRef)("none"!==(null===k||void 0===k||null===(f=k.clickType)||void 0===f?void 0:f.name)?(0,c.Z)({src:null===k||void 0===k||null===(p=k.clickType)||void 0===p?void 0:p.src,volume:null===k||void 0===k?void 0:k.clickVolume}):null);(0,i.useEffect)((function(){var o,e,n,t,i;void 0!=typeof(null===(o=window)||void 0===o?void 0:o.Notification)&&("default"===(null===(e=window)||void 0===e||null===(n=e.Notification)||void 0===n?void 0:n.permission)&&(null===(t=window)||void 0===t||null===(i=t.Notification)||void 0===i||i.requestPermission()))}),[]),(0,i.useEffect)((function(){document.body.style.backgroundColor=h[y].color,void 0!==k.time&&((null===k||void 0===k?void 0:k.time[y])-Number(localStorage.getItem("restOfTime"))>1?P((null===k||void 0===k?void 0:k.time[y])-Number(localStorage.getItem("restOfTime"))):(V((0,r.P8)(y,b)),localStorage.setItem("restOfTime",0)))}),[y,k.time]),(0,i.useEffect)((function(){"none"!==(null===k||void 0===k?void 0:k.tickingType.name)&&(x.current.chengeVolume(null===k||void 0===k?void 0:k.tickingVolume),x.current.changeFile(null===k||void 0===k?void 0:k.tickingType.src)),B.current.chengeVolume(null===k||void 0===k?void 0:k.alarmVolume),B.current.changeFile(null===k||void 0===k?void 0:k.alarmType.src),B.current.changeLoop(null===k||void 0===k?void 0:k.alarmRepet),"none"!==k.clickType.name&&(F.current.chengeVolume(k.clickVolume),F.current.changeFile(k.clickType.src))}),[k]),(0,i.useEffect)((function(){(y!==r.aI&&k.autoPomodors||y===r.aI&&k.autoBreaks)&&0!==T&&w&&(setTimeout((function(){B.current.handleStop(),"none"!==k.tickingType.name&&x.current.handlePlay(),v.postMessage({started:!w,count:k.time[y]}),V({type:r.BG,data:0}),console.log(S,0,"autoBreaks autoPomodors")}),1e3),console.log(y))}),[y,k.autoBreaks,k.autoPomodors]),(0,i.useEffect)((function(){w?(document.body.onbeforeunload=function(){return function(){return"Hello, world!"}},k.focusMode&&(document.body.style.backgroundColor="rgb(30 30 30)",document.body.style.overflow="hidden")):(document.body.onbeforeunload=null,k.focusMode&&(document.body.style.backgroundColor=h[y].color,document.body.style.overflow="auto"))}),[w]),v.onmessage=function(o){if("stop"!==o.data){var e,n,t;if(P(o.data),void 0!=typeof(null===(e=window)||void 0===e?void 0:e.Notification))"granted"===(null===(n=window)||void 0===n||null===(t=n.Notification)||void 0===t?void 0:t.permission)&&0!==S&&("every"===k.notificationType?S%(60*k.notificationInterval)===0&&S!==j&&(0,a.h)("".concat(S/60," minutes left!")):S-60*k.notificationInterval===0&&S!==j&&(0,a.h)("".concat(S/60," minutes left!")))}else{var i,l;if(console.log(o.data,S,0,"worker stop"),B.current.handlePlay(),"none"!==k.tickingType.name&&x.current.handleStop(),void 0!=typeof(null===(i=window)||void 0===i?void 0:i.Notification))"granted"===(null===(l=window)||void 0===l?void 0:l.Notification.permission)&&(y===r.aI?(0,a.h)("It's time to take a break"):(0,a.h)("It's time to focus!"));(y===r.aI||k.autoPomodors)&&(y!==r.aI||k.autoBreaks)||0===T||w||V({type:r.pt,data:0}),V((0,r.P8)(y,b))}};var R=(0,i.useCallback)((function(){console.log("toggle start"),"none"!==k.clickType.name&&F.current.handlePlay(),B.current.handleStop(),w?(v.postMessage("stop"),"none"!==k.tickingType.name&&x.current.handleStop(),V({type:r.pt,data:k.time[y]-S})):("none"!==k.tickingType.name&&x.current.handlePlay(),w||v.postMessage({started:!w,count:S}),V({type:r.BG,data:0}))}),[w,S]),C=function(){P(j),"none"!==k.clickType.name&&F.current.handlePlay(),localStorage.setItem("restOfTime",0)};return(0,d.jsx)(d.Fragment,{children:(0,d.jsx)("div",{className:"clock-container",style:{background:h[y].timerBorder},children:(0,d.jsx)("div",{className:"clock",children:(0,d.jsx)(i.Suspense,{fallback:(0,d.jsx)(u.Z,{color:h[y].color,backgroud:"transparent",size:"200",strokeWidth:"2.5"}),children:"digital"===k.format?(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(m,{handleReset:C,toggleStart:R,setTime:P,time:S})}):(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(s,{handleReset:C,toggleStart:R,setTime:P,time:S})})})})})})}},771:function(o,e){e.Z=function(o){var e=o.src,n=o.volume,t=void 0===n?50:n,i=o.loop,l=void 0!==i&&i,r=new Audio;r.src=e,r.volume=t/100,r.loop=l;return{handlePlay:function(){!r.paused&&r.currentTime||r.play().catch((function(){}))},handleStop:function(){r.pause()},chengeVolume:function(o){return r.volume=o/100},changeFile:function(o){r.pause(),r.src=o},changeLoop:function(o){r.loop=o}}}},7710:function(o,e,n){n.d(e,{h:function(){return i},m:function(){return t}});var t=function(o){var e=o%60,n=Math.floor(o/60);return"".concat(n>=10?n:"0"+n,":").concat(e>=10?e:"0"+e)},i=function(o){var e;void 0!==typeof(null===(e=window)||void 0===e?void 0:e.Notification)&&new window.Notification(o,{icon:"favicon.ico",tag:"mohamed ali",requireInteraction:!0,renotify:!0})}}}]);
//# sourceMappingURL=804.7077a7c0.chunk.js.map